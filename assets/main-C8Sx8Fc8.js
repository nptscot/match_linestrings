import{p as Ge,f as me,a as ce,b as qe,m as Re,l as Qe,c as se,S as ze,i as He,s as We,L as Ke,d as H,t as q,e as G,g as W,h as K,o as Ze,_ as Ue,j as Ve,k as we,n as M,q as Xe,r as Ye,u as N,v as B,w as re,x as O,y as T,z,A as D,M as xe,B as X,C as ie,D as oe,E as U,F as et,G as _e,H as ve,I as tt,J as nt,K as ue,N as rt,O as be,P as je,Q as pe}from"./Settings-CV3NVTZE.js";function st(t,e={}){const n=Number(t[0]),r=Number(t[1]),l=Number(t[2]),s=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const o=[n,r];return Ge([[o,[l,r],[l,s],[n,s],o]],e.properties,{bbox:t,id:e.id})}const R=11102230246251565e-32,A=134217729,it=(3+8*R)*R;function fe(t,e,n,r,l){let s,o,i,f,p=e[0],u=r[0],a=0,h=0;u>p==u>-p?(s=p,p=e[++a]):(s=u,u=r[++h]);let c=0;if(a<t&&h<n)for(u>p==u>-p?(o=p+s,i=s-(o-p),p=e[++a]):(o=u+s,i=s-(o-u),u=r[++h]),s=o,i!==0&&(l[c++]=i);a<t&&h<n;)u>p==u>-p?(o=s+p,f=o-s,i=s-(o-f)+(p-f),p=e[++a]):(o=s+u,f=o-s,i=s-(o-f)+(u-f),u=r[++h]),s=o,i!==0&&(l[c++]=i);for(;a<t;)o=s+p,f=o-s,i=s-(o-f)+(p-f),p=e[++a],s=o,i!==0&&(l[c++]=i);for(;h<n;)o=s+u,f=o-s,i=s-(o-f)+(u-f),u=r[++h],s=o,i!==0&&(l[c++]=i);return(s!==0||c===0)&&(l[c++]=s),c}function ot(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Y(t){return new Float64Array(t)}const lt=(3+16*R)*R,at=(2+12*R)*R,ut=(9+64*R)*R*R,Z=Y(4),$e=Y(8),Ee=Y(12),Se=Y(16),j=Y(4);function ft(t,e,n,r,l,s,o){let i,f,p,u,a,h,c,d,g,w,y,v,L,b,P,$,C,k;const m=t-l,E=n-l,F=e-s,S=r-s;b=m*S,h=A*m,c=h-(h-m),d=m-c,h=A*S,g=h-(h-S),w=S-g,P=d*w-(b-c*g-d*g-c*w),$=F*E,h=A*F,c=h-(h-F),d=F-c,h=A*E,g=h-(h-E),w=E-g,C=d*w-($-c*g-d*g-c*w),y=P-C,a=P-y,Z[0]=P-(y+a)+(a-C),v=b+y,a=v-b,L=b-(v-a)+(y-a),y=L-$,a=L-y,Z[1]=L-(y+a)+(a-$),k=v+y,a=k-v,Z[2]=v-(k-a)+(y-a),Z[3]=k;let J=ot(4,Z),Q=at*o;if(J>=Q||-J>=Q||(a=t-m,i=t-(m+a)+(a-l),a=n-E,p=n-(E+a)+(a-l),a=e-F,f=e-(F+a)+(a-s),a=r-S,u=r-(S+a)+(a-s),i===0&&f===0&&p===0&&u===0)||(Q=ut*o+it*Math.abs(J),J+=m*u+S*i-(F*p+E*f),J>=Q||-J>=Q))return J;b=i*S,h=A*i,c=h-(h-i),d=i-c,h=A*S,g=h-(h-S),w=S-g,P=d*w-(b-c*g-d*g-c*w),$=f*E,h=A*f,c=h-(h-f),d=f-c,h=A*E,g=h-(h-E),w=E-g,C=d*w-($-c*g-d*g-c*w),y=P-C,a=P-y,j[0]=P-(y+a)+(a-C),v=b+y,a=v-b,L=b-(v-a)+(y-a),y=L-$,a=L-y,j[1]=L-(y+a)+(a-$),k=v+y,a=k-v,j[2]=v-(k-a)+(y-a),j[3]=k;const ae=fe(4,Z,4,j,$e);b=m*u,h=A*m,c=h-(h-m),d=m-c,h=A*u,g=h-(h-u),w=u-g,P=d*w-(b-c*g-d*g-c*w),$=F*p,h=A*F,c=h-(h-F),d=F-c,h=A*p,g=h-(h-p),w=p-g,C=d*w-($-c*g-d*g-c*w),y=P-C,a=P-y,j[0]=P-(y+a)+(a-C),v=b+y,a=v-b,L=b-(v-a)+(y-a),y=L-$,a=L-y,j[1]=L-(y+a)+(a-$),k=v+y,a=k-v,j[2]=v-(k-a)+(y-a),j[3]=k;const x=fe(ae,$e,4,j,Ee);b=i*u,h=A*i,c=h-(h-i),d=i-c,h=A*u,g=h-(h-u),w=u-g,P=d*w-(b-c*g-d*g-c*w),$=f*p,h=A*f,c=h-(h-f),d=f-c,h=A*p,g=h-(h-p),w=p-g,C=d*w-($-c*g-d*g-c*w),y=P-C,a=P-y,j[0]=P-(y+a)+(a-C),v=b+y,a=v-b,L=b-(v-a)+(y-a),y=L-$,a=L-y,j[1]=L-(y+a)+(a-$),k=v+y,a=k-v,j[2]=v-(k-a)+(y-a),j[3]=k;const _=fe(x,Ee,4,j,Se);return Se[_-1]}function ct(t,e,n,r,l,s){const o=(e-s)*(n-l),i=(t-l)*(r-s),f=o-i,p=Math.abs(o+i);return Math.abs(f)>=lt*p?f:-ft(t,e,n,r,l,s,p)}function pt(t,e){var n,r,l=0,s,o,i,f,p,u,a,h=t[0],c=t[1],d=e.length;for(n=0;n<d;n++){r=0;var g=e[n],w=g.length-1;if(u=g[0],u[0]!==g[w][0]&&u[1]!==g[w][1])throw new Error("First and last coordinates in a ring must be the same");for(o=u[0]-h,i=u[1]-c,r;r<w;r++){if(a=g[r+1],f=a[0]-h,p=a[1]-c,i===0&&p===0){if(f<=0&&o>=0||o<=0&&f>=0)return 0}else if(p>=0&&i<=0||p<=0&&i>=0){if(s=ct(o,f,i,p,0,0),s===0)return 0;(s>0&&p>0&&i<=0||s<0&&p<=0&&i>0)&&l++}u=a,i=p,o=f}}return l%2!==0}function ht(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function le(t){return t.type==="Feature"?t.geometry:t}function V(t,e,n={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const r=ht(t),l=le(e),s=l.type,o=e.bbox;let i=l.coordinates;if(o&&dt(r,o)===!1)return!1;s==="Polygon"&&(i=[i]);let f=!1;for(var p=0;p<i.length;++p){const u=pt(r,i[p]);if(u===0)return!n.ignoreBoundary;u&&(f=!0)}return f}function dt(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}class Oe{constructor(e=[],n=gt){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:r}=this,l=n[e];for(;e>0;){const s=e-1>>1,o=n[s];if(r(l,o)>=0)break;n[e]=o,e=s}n[e]=l}_down(e){const{data:n,compare:r}=this,l=this.length>>1,s=n[e];for(;e<l;){let o=(e<<1)+1,i=n[o];const f=o+1;if(f<this.length&&r(n[f],i)<0&&(o=f,i=n[f]),r(i,s)>=0)break;n[e]=i,e=o}n[e]=s}}function gt(t,e){return t<e?-1:t>e?1:0}function Je(t,e){return t.p.x>e.p.x?1:t.p.x<e.p.x?-1:t.p.y!==e.p.y?t.p.y>e.p.y?1:-1:1}function yt(t,e){return t.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:t.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:t.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?t.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class Le{constructor(e,n,r,l){this.p={x:e[0],y:e[1]},this.featureId=n,this.ringId=r,this.eventId=l,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}}function mt(t,e){if(t.type==="FeatureCollection"){const n=t.features;for(let r=0;r<n.length;r++)Pe(n[r],e)}else Pe(t,e)}let ee=0,te=0,ne=0;function Pe(t,e){const n=t.type==="Feature"?t.geometry:t;let r=n.coordinates;(n.type==="Polygon"||n.type==="MultiLineString")&&(r=[r]),n.type==="LineString"&&(r=[[r]]);for(let l=0;l<r.length;l++)for(let s=0;s<r[l].length;s++){let o=r[l][s][0],i=null;te=te+1;for(let f=0;f<r[l][s].length-1;f++){i=r[l][s][f+1];const p=new Le(o,ee,te,ne),u=new Le(i,ee,te,ne+1);p.otherEvent=u,u.otherEvent=p,Je(p,u)>0?(u.isLeftEndpoint=!0,p.isLeftEndpoint=!1):(p.isLeftEndpoint=!0,u.isLeftEndpoint=!1),e.push(p),e.push(u),o=i,ne=ne+1}}ee=ee+1}class wt{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function _t(t,e){if(t===null||e===null||t.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.rightSweepEvent)||t.leftSweepEvent.isSamePoint(e.leftSweepEvent)||t.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const n=t.leftSweepEvent.p.x,r=t.leftSweepEvent.p.y,l=t.rightSweepEvent.p.x,s=t.rightSweepEvent.p.y,o=e.leftSweepEvent.p.x,i=e.leftSweepEvent.p.y,f=e.rightSweepEvent.p.x,p=e.rightSweepEvent.p.y,u=(p-i)*(l-n)-(f-o)*(s-r),a=(f-o)*(r-i)-(p-i)*(n-o),h=(l-n)*(r-i)-(s-r)*(n-o);if(u===0)return!1;const c=a/u,d=h/u;if(c>=0&&c<=1&&d>=0&&d<=1){const g=n+c*(l-n),w=r+c*(s-r);return[g,w]}return!1}function vt(t,e){e=e||!1;const n=[],r=new Oe([],yt);for(;t.length;){const l=t.pop();if(l.isLeftEndpoint){const s=new wt(l);for(let o=0;o<r.data.length;o++){const i=r.data[o];if(e&&i.leftSweepEvent.featureId===l.featureId)continue;const f=_t(s,i);f!==!1&&n.push(f)}r.push(s)}else l.isLeftEndpoint===!1&&r.pop()}return n}function bt(t,e){const n=new Oe([],Je);return mt(t,n),vt(n,e)}var $t=bt;function ge(t,e,n={}){const{removeDuplicates:r=!0,ignoreSelfIntersections:l=!0}=n;let s=[];t.type==="FeatureCollection"?s=s.concat(t.features):t.type==="Feature"?s.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&s.push(me(t)),e.type==="FeatureCollection"?s=s.concat(e.features):e.type==="Feature"?s.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&s.push(me(e));const o=$t(ce(s),l);let i=[];if(r){const f={};o.forEach(p=>{const u=p.join(",");f[u]||(f[u]=!0,i.push(p))})}else i=o;return ce(i.map(f=>qe(f)))}function he(t,e={}){const n=le(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),n.type){case"Polygon":return Et(n,e);case"MultiPolygon":return St(n,e);default:throw new Error("invalid poly")}}function Et(t,e={}){const r=le(t).coordinates,l=e.properties?e.properties:t.type==="Feature"?t.properties:{};return Te(r,l)}function St(t,e={}){const r=le(t).coordinates,l=e.properties?e.properties:t.type==="Feature"?t.properties:{},s=[];return r.forEach(o=>{s.push(Te(o,l))}),ce(s)}function Te(t,e){return t.length>1?Re(t,e):Qe(t[0],e)}function Lt(t,e,{ignoreSelfIntersections:n=!0}={ignoreSelfIntersections:!0}){let r=!0;return se(t,l=>{se(e,s=>{if(r===!1)return!1;r=Pt(l.geometry,s.geometry,n)})}),r}function Pt(t,e,n){switch(t.type){case"Point":switch(e.type){case"Point":return!Ft(t.coordinates,e.coordinates);case"LineString":return!Ce(e,t);case"Polygon":return!V(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ce(t,e);case"LineString":return!Ct(t,e,n);case"Polygon":return!ke(e,t,n)}break;case"Polygon":switch(e.type){case"Point":return!V(e,t);case"LineString":return!ke(t,e,n);case"Polygon":return!kt(e,t,n)}}return!1}function Ce(t,e){for(let n=0;n<t.coordinates.length-1;n++)if(It(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function Ct(t,e,n){return ge(t,e,{ignoreSelfIntersections:n}).features.length>0}function ke(t,e,n){for(const l of e.coordinates)if(V(l,t))return!0;return ge(e,he(t),{ignoreSelfIntersections:n}).features.length>0}function kt(t,e,n){for(const l of t.coordinates[0])if(V(l,e))return!0;for(const l of e.coordinates[0])if(V(l,t))return!0;return ge(he(t),he(e),{ignoreSelfIntersections:n}).features.length>0}function It(t,e,n){const r=n[0]-t[0],l=n[1]-t[1],s=e[0]-t[0],o=e[1]-t[1];return r*o-l*s!==0?!1:Math.abs(s)>=Math.abs(o)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:o>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}function Ft(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ie(t,e,{ignoreSelfIntersections:n=!0}={}){let r=!1;return se(t,l=>{se(e,s=>{if(r===!0)return!0;r=!Lt(l.geometry,s.geometry,{ignoreSelfIntersections:n})})}),r}function Fe(t){let e,n,r,l,s,o,i,f=t[4].features.length+"",p,u,a,h,c,d,g=t[5].features.length+"",w,y,v=t[1].filter(Be).length+"",L,b,P,$,C,k,m,E,F,S,J,Q;function ae(_){t[21](_)}let x={onChange:t[10]};return t[7]!==void 0&&(x.options=t[7]),E=new tt({props:x}),X.push(()=>ie(E,"options",ae)),{c(){e=O("button"),e.textContent="Swap",n=T(),r=O("button"),r.textContent="Zoom to fit",l=T(),s=O("div"),s.textContent="Sources",o=T(),i=O("p"),p=z(f),u=z(" sources"),a=T(),h=O("div"),h.textContent="Target",c=T(),d=O("p"),w=z(g),y=z(" targets, with "),L=z(v),b=z(" matching a source"),P=T(),$=O("label"),C=O("input"),k=z(`
        Show targets matching a source`),m=T(),K(E.$$.fragment),D(e,"class","btn btn-secondary"),D(r,"class","btn btn-secondary"),U(s,"background",de),U(h,"background",De),D(C,"class","form-check-input"),D(C,"type","checkbox"),D($,"class","form-check-label mb-3")},m(_,I){N(_,e,I),N(_,n,I),N(_,r,I),N(_,l,I),N(_,s,I),N(_,o,I),N(_,i,I),B(i,p),B(i,u),N(_,a,I),N(_,h,I),N(_,c,I),N(_,d,I),B(d,w),B(d,y),B(d,L),B(d,b),N(_,P,I),N(_,$,I),B($,C),C.checked=t[6],B($,k),N(_,m,I),W(E,_,I),S=!0,J||(Q=[re(e,"click",t[13]),re(r,"click",t[12]),re(C,"change",t[20])],J=!0)},p(_,I){(!S||I&16)&&f!==(f=_[4].features.length+"")&&ue(p,f),(!S||I&32)&&g!==(g=_[5].features.length+"")&&ue(w,g),(!S||I&2)&&v!==(v=_[1].filter(Be).length+"")&&ue(L,v),I&64&&(C.checked=_[6]);const ye={};!F&&I&128&&(F=!0,ye.options=_[7],oe(()=>F=!1)),E.$set(ye)},i(_){S||(G(E.$$.fragment,_),S=!0)},o(_){q(E.$$.fragment,_),S=!1},d(_){_&&(M(e),M(n),M(r),M(l),M(s),M(o),M(i),M(a),M(h),M(c),M(d),M(P),M($),M(m)),H(E,_),J=!1,nt(Q)}}}function Mt(t){let e,n,r,l,s,o,i,f,p,u,a,h,c=t[4].features.length>0&&Fe(t);return{c(){e=O("div"),n=O("h1"),n.textContent="Match LineStrings",r=T(),l=O("a"),l.textContent="Looking for the tool to review test cases?",s=T(),o=O("label"),i=z(`Load two .geojson files
      `),f=O("input"),p=T(),c&&c.c(),D(l,"href","review.html"),D(f,"class","form-control"),D(f,"type","file"),f.multiple=!0,D(o,"class","form-label"),D(e,"slot","left")},m(d,g){N(d,e,g),B(e,n),B(e,r),B(e,l),B(e,s),B(e,o),B(o,i),B(o,f),t[19](f),B(e,p),c&&c.m(e,null),u=!0,a||(h=re(f,"change",t[11]),a=!0)},p(d,g){d[4].features.length>0?c?(c.p(d,g),g&16&&G(c,1)):(c=Fe(d),c.c(),G(c,1),c.m(e,null)):c&&(Xe(),q(c,1,1,()=>{c=null}),Ye())},i(d){u||(G(c),u=!0)},o(d){q(c),u=!1},d(d){d&&M(e),t[19](null),c&&c.d(),a=!1,h()}}}function Nt(t){let e,n;return e=new je({props:{manageHoverState:!0,paint:{"line-width":["case",["in",["id"],["literal",t[9]]],8,5],"line-color":de,"line-opacity":pe(.5,1)}}}),{c(){K(e.$$.fragment)},m(r,l){W(e,r,l),n=!0},p(r,l){const s={};l&512&&(s.paint={"line-width":["case",["in",["id"],["literal",r[9]]],8,5],"line-color":de,"line-opacity":pe(.5,1)}),e.$set(s)},i(r){n||(G(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function At(t){let e,n,r;function l(o){t[16](o)}let s={manageHoverState:!0,filter:t[6]?void 0:["!",["get","has_match"]],paint:{"line-width":8,"line-color":De,"line-opacity":pe(["case",["get","has_match"],.5,.2],1)}};return t[0]!==void 0&&(s.hovered=t[0]),e=new je({props:s}),X.push(()=>ie(e,"hovered",l)),e.$on("click",t[14]),{c(){K(e.$$.fragment)},m(o,i){W(e,o,i),r=!0},p(o,i){const f={};i&64&&(f.filter=o[6]?void 0:["!",["get","has_match"]]),!n&&i&1&&(n=!0,f.hovered=o[0],oe(()=>n=!1)),e.$set(f)},i(o){r||(G(e.$$.fragment,o),r=!0)},o(o){q(e.$$.fragment,o),r=!1},d(o){H(e,o)}}}function Bt(t){let e,n,r,l,s,o,i;function f(u){t[15](u)}let p={choice:"Maptiler Dataviz"};return t[3]!==void 0&&(p.style=t[3]),e=new rt({props:p}),X.push(()=>ie(e,"style",f)),l=new be({props:{data:t[4],$$slots:{default:[Nt]},$$scope:{ctx:t}}}),o=new be({props:{data:t[5],$$slots:{default:[At]},$$scope:{ctx:t}}}),{c(){K(e.$$.fragment),r=T(),K(l.$$.fragment),s=T(),K(o.$$.fragment)},m(u,a){W(e,u,a),N(u,r,a),W(l,u,a),N(u,s,a),W(o,u,a),i=!0},p(u,a){const h={};!n&&a&8&&(n=!0,h.style=u[3],oe(()=>n=!1)),e.$set(h);const c={};a&16&&(c.data=u[4]),a&4194816&&(c.$$scope={dirty:a,ctx:u}),l.$set(c);const d={};a&32&&(d.data=u[5]),a&4194369&&(d.$$scope={dirty:a,ctx:u}),o.$set(d)},i(u){i||(G(e.$$.fragment,u),G(l.$$.fragment,u),G(o.$$.fragment,u),i=!0)},o(u){q(e.$$.fragment,u),q(l.$$.fragment,u),q(o.$$.fragment,u),i=!1},d(u){u&&(M(r),M(s)),H(e,u),H(l,u),H(o,u)}}}function jt(t){let e,n,r,l;function s(i){t[17](i)}let o={style:t[3],standardControls:!0,hash:!0,$$slots:{default:[Bt]},$$scope:{ctx:t}};return t[2]!==void 0&&(o.map=t[2]),n=new xe({props:o}),X.push(()=>ie(n,"map",s)),n.$on("error",t[18]),{c(){e=O("div"),K(n.$$.fragment),D(e,"slot","main"),U(e,"position","relative"),U(e,"width","100%"),U(e,"height","100vh")},m(i,f){N(i,e,f),W(n,e,null),l=!0},p(i,f){const p={};f&8&&(p.style=i[3]),f&4194937&&(p.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,p.map=i[2],oe(()=>r=!1)),n.$set(p)},i(i){l||(G(n.$$.fragment,i),l=!0)},o(i){q(n.$$.fragment,i),l=!1},d(i){i&&M(e),H(n)}}}function Ot(t){let e,n;return e=new Ke({props:{$$slots:{main:[jt],left:[Mt]},$$scope:{ctx:t}}}),{c(){K(e.$$.fragment)},m(r,l){W(e,r,l),n=!0},p(r,[l]){const s={};l&4195327&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){n||(G(e.$$.fragment,r),n=!0)},o(r){q(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}let de="red",De="blue";async function Me(t){let e=await t.text(),n=JSON.parse(e),r=0;for(let l of n.features)l.id=r++,l.properties??(l.properties={});return n}function Ne(t){let e=JSON.parse(JSON.stringify(t));return delete e.properties,e}function Ae(t){let e=0;for(let n of t)n.id=e++;return t}const Be=t=>t.matching_sources.length>0;function Jt(t,e,n){let r,l,s=Ve["Maptiler Dataviz"],o=we(),i=we(),f=null,p=!0,u={buffer_meters:20,angle_diff_threshold:10,length_ratio_threshold:1.1,midpt_dist_threshold:15},a=[];Ze(async()=>{await Ue()});function h(){try{n(1,a=JSON.parse(et(JSON.stringify(o),JSON.stringify(i),u)))}catch(m){window.alert(`Bug: ${m}`);return}for(let[m,E]of i.features.entries())E.properties.has_match=a[m].matching_sources.length>0;n(5,i)}let c;async function d(m){if(!c.files)return;if(c.files.length!=2){window.alert("Select two GeoJSON files");return}try{n(4,o=await Me(c.files[0])),n(5,i=await Me(c.files[1])),g(),n(0,f=null),h()}catch(F){window.alert(`Bad input file: ${F}`)}}function g(){let m={type:"FeatureCollection",features:[...o.features,...i.features]};l==null||l.fitBounds(_e(m),{animate:!1,padding:10})}function w(){n(4,[o,i]=[i,o],o,n(5,i)),h()}function y(m){let E=i.features[m.detail.features[0].id],F=st(_e(E));ve("sources.geojson",JSON.stringify({type:"FeatureCollection",features:Ae(o.features.filter(S=>Ie(S,F)).map(Ne))})),ve("targets.geojson",JSON.stringify({type:"FeatureCollection",features:Ae(i.features.filter(S=>Ie(S,F)).map(Ne))}))}function v(m){s=m,n(3,s)}function L(m){f=m,n(0,f)}function b(m){l=m,n(2,l)}const P=m=>{console.log(m.detail.error)};function $(m){X[m?"unshift":"push"](()=>{c=m,n(8,c)})}function C(){p=this.checked,n(6,p)}function k(m){u=m,n(7,u)}return t.$$.update=()=>{t.$$.dirty&3&&n(9,r=f==null?[]:a[f.id].matching_sources)},[f,a,l,s,o,i,p,u,c,r,h,d,g,w,y,v,L,b,P,$,C,k]}class Tt extends ze{constructor(e){super(),He(this,e,Jt,Ot,We,{})}}new Tt({target:document.getElementById("app")});
