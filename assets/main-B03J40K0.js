import{p as qe,f as _e,a as pe,b as Qe,m as ze,l as He,c as oe,S as We,i as Ke,s as Ue,L as Ze,d as R,t as T,e as J,g as q,h as Q,o as Ve,_ as Xe,j as Ye,k as $e,n as I,q as xe,r as et,u as F,v as j,w as he,x as G,y as O,z as H,A as W,M as tt,B as Z,C as X,D as Y,E as V,F as nt,G as ve,H as be,I as rt,J as st,K as it,N as fe,O as ot,P as lt,Q as at,R as Se,T as Je,U as de}from"./Settings-CVLmKh1f.js";function ut(t,e={}){const n=Number(t[0]),r=Number(t[1]),l=Number(t[2]),s=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const o=[n,r];return qe([[o,[l,r],[l,s],[n,s],o]],e.properties,{bbox:t,id:e.id})}const z=11102230246251565e-32,A=134217729,ft=(3+8*z)*z;function ce(t,e,n,r,l){let s,o,i,a,p=e[0],d=r[0],u=0,h=0;d>p==d>-p?(s=p,p=e[++u]):(s=d,d=r[++h]);let c=0;if(u<t&&h<n)for(d>p==d>-p?(o=p+s,i=s-(o-p),p=e[++u]):(o=d+s,i=s-(o-d),d=r[++h]),s=o,i!==0&&(l[c++]=i);u<t&&h<n;)d>p==d>-p?(o=s+p,a=o-s,i=s-(o-a)+(p-a),p=e[++u]):(o=s+d,a=o-s,i=s-(o-a)+(d-a),d=r[++h]),s=o,i!==0&&(l[c++]=i);for(;u<t;)o=s+p,a=o-s,i=s-(o-a)+(p-a),p=e[++u],s=o,i!==0&&(l[c++]=i);for(;h<n;)o=s+d,a=o-s,i=s-(o-a)+(d-a),d=r[++h],s=o,i!==0&&(l[c++]=i);return(s!==0||c===0)&&(l[c++]=s),c}function ct(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function ee(t){return new Float64Array(t)}const pt=(3+16*z)*z,ht=(2+12*z)*z,dt=(9+64*z)*z*z,U=ee(4),Ee=ee(8),Le=ee(12),Pe=ee(16),B=ee(4);function gt(t,e,n,r,l,s,o){let i,a,p,d,u,h,c,f,g,y,m,$,S,v,P,b,N,k;const w=t-l,C=n-l,E=e-s,M=r-s;v=w*M,h=A*w,c=h-(h-w),f=w-c,h=A*M,g=h-(h-M),y=M-g,P=f*y-(v-c*g-f*g-c*y),b=E*C,h=A*E,c=h-(h-E),f=E-c,h=A*C,g=h-(h-C),y=C-g,N=f*y-(b-c*g-f*g-c*y),m=P-N,u=P-m,U[0]=P-(m+u)+(u-N),$=v+m,u=$-v,S=v-($-u)+(m-u),m=S-b,u=S-m,U[1]=S-(m+u)+(u-b),k=$+m,u=k-$,U[2]=$-(k-u)+(m-u),U[3]=k;let D=ct(4,U),K=ht*o;if(D>=K||-D>=K||(u=t-w,i=t-(w+u)+(u-l),u=n-C,p=n-(C+u)+(u-l),u=e-E,a=e-(E+u)+(u-s),u=r-M,d=r-(M+u)+(u-s),i===0&&a===0&&p===0&&d===0)||(K=dt*o+ft*Math.abs(D),D+=w*d+M*i-(E*p+C*a),D>=K||-D>=K))return D;v=i*M,h=A*i,c=h-(h-i),f=i-c,h=A*M,g=h-(h-M),y=M-g,P=f*y-(v-c*g-f*g-c*y),b=a*C,h=A*a,c=h-(h-a),f=a-c,h=A*C,g=h-(h-C),y=C-g,N=f*y-(b-c*g-f*g-c*y),m=P-N,u=P-m,B[0]=P-(m+u)+(u-N),$=v+m,u=$-v,S=v-($-u)+(m-u),m=S-b,u=S-m,B[1]=S-(m+u)+(u-b),k=$+m,u=k-$,B[2]=$-(k-u)+(m-u),B[3]=k;const te=ce(4,U,4,B,Ee);v=w*d,h=A*w,c=h-(h-w),f=w-c,h=A*d,g=h-(h-d),y=d-g,P=f*y-(v-c*g-f*g-c*y),b=E*p,h=A*E,c=h-(h-E),f=E-c,h=A*p,g=h-(h-p),y=p-g,N=f*y-(b-c*g-f*g-c*y),m=P-N,u=P-m,B[0]=P-(m+u)+(u-N),$=v+m,u=$-v,S=v-($-u)+(m-u),m=S-b,u=S-m,B[1]=S-(m+u)+(u-b),k=$+m,u=k-$,B[2]=$-(k-u)+(m-u),B[3]=k;const ae=ce(te,Ee,4,B,Le);v=i*d,h=A*i,c=h-(h-i),f=i-c,h=A*d,g=h-(h-d),y=d-g,P=f*y-(v-c*g-f*g-c*y),b=a*p,h=A*a,c=h-(h-a),f=a-c,h=A*p,g=h-(h-p),y=p-g,N=f*y-(b-c*g-f*g-c*y),m=P-N,u=P-m,B[0]=P-(m+u)+(u-N),$=v+m,u=$-v,S=v-($-u)+(m-u),m=S-b,u=S-m,B[1]=S-(m+u)+(u-b),k=$+m,u=k-$,B[2]=$-(k-u)+(m-u),B[3]=k;const ne=ce(ae,Le,4,B,Pe);return Pe[ne-1]}function mt(t,e,n,r,l,s){const o=(e-s)*(n-l),i=(t-l)*(r-s),a=o-i,p=Math.abs(o+i);return Math.abs(a)>=pt*p?a:-gt(t,e,n,r,l,s,p)}function wt(t,e){var n,r,l=0,s,o,i,a,p,d,u,h=t[0],c=t[1],f=e.length;for(n=0;n<f;n++){r=0;var g=e[n],y=g.length-1;if(d=g[0],d[0]!==g[y][0]&&d[1]!==g[y][1])throw new Error("First and last coordinates in a ring must be the same");for(o=d[0]-h,i=d[1]-c,r;r<y;r++){if(u=g[r+1],a=u[0]-h,p=u[1]-c,i===0&&p===0){if(a<=0&&o>=0||o<=0&&a>=0)return 0}else if(p>=0&&i<=0||p<=0&&i>=0){if(s=mt(o,a,i,p,0,0),s===0)return 0;(s>0&&p>0&&i<=0||s<0&&p<=0&&i>0)&&l++}d=u,i=p,o=a}}return l%2!==0}function yt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function le(t){return t.type==="Feature"?t.geometry:t}function x(t,e,n={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const r=yt(t),l=le(e),s=l.type,o=e.bbox;let i=l.coordinates;if(o&&_t(r,o)===!1)return!1;s==="Polygon"&&(i=[i]);let a=!1;for(var p=0;p<i.length;++p){const d=wt(r,i[p]);if(d===0)return!n.ignoreBoundary;d&&(a=!0)}return a}function _t(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}class Te{constructor(e=[],n=$t){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:r}=this,l=n[e];for(;e>0;){const s=e-1>>1,o=n[s];if(r(l,o)>=0)break;n[e]=o,e=s}n[e]=l}_down(e){const{data:n,compare:r}=this,l=this.length>>1,s=n[e];for(;e<l;){let o=(e<<1)+1,i=n[o];const a=o+1;if(a<this.length&&r(n[a],i)<0&&(o=a,i=n[a]),r(i,s)>=0)break;n[e]=i,e=o}n[e]=s}}function $t(t,e){return t<e?-1:t>e?1:0}function De(t,e){return t.p.x>e.p.x?1:t.p.x<e.p.x?-1:t.p.y!==e.p.y?t.p.y>e.p.y?1:-1:1}function vt(t,e){return t.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:t.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:t.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?t.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class ke{constructor(e,n,r,l){this.p={x:e[0],y:e[1]},this.featureId=n,this.ringId=r,this.eventId=l,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}}function bt(t,e){if(t.type==="FeatureCollection"){const n=t.features;for(let r=0;r<n.length;r++)Ce(n[r],e)}else Ce(t,e)}let re=0,se=0,ie=0;function Ce(t,e){const n=t.type==="Feature"?t.geometry:t;let r=n.coordinates;(n.type==="Polygon"||n.type==="MultiLineString")&&(r=[r]),n.type==="LineString"&&(r=[[r]]);for(let l=0;l<r.length;l++)for(let s=0;s<r[l].length;s++){let o=r[l][s][0],i=null;se=se+1;for(let a=0;a<r[l][s].length-1;a++){i=r[l][s][a+1];const p=new ke(o,re,se,ie),d=new ke(i,re,se,ie+1);p.otherEvent=d,d.otherEvent=p,De(p,d)>0?(d.isLeftEndpoint=!0,p.isLeftEndpoint=!1):(p.isLeftEndpoint=!0,d.isLeftEndpoint=!1),e.push(p),e.push(d),o=i,ie=ie+1}}re=re+1}class St{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function Et(t,e){if(t===null||e===null||t.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.rightSweepEvent)||t.leftSweepEvent.isSamePoint(e.leftSweepEvent)||t.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const n=t.leftSweepEvent.p.x,r=t.leftSweepEvent.p.y,l=t.rightSweepEvent.p.x,s=t.rightSweepEvent.p.y,o=e.leftSweepEvent.p.x,i=e.leftSweepEvent.p.y,a=e.rightSweepEvent.p.x,p=e.rightSweepEvent.p.y,d=(p-i)*(l-n)-(a-o)*(s-r),u=(a-o)*(r-i)-(p-i)*(n-o),h=(l-n)*(r-i)-(s-r)*(n-o);if(d===0)return!1;const c=u/d,f=h/d;if(c>=0&&c<=1&&f>=0&&f<=1){const g=n+c*(l-n),y=r+c*(s-r);return[g,y]}return!1}function Lt(t,e){e=e||!1;const n=[],r=new Te([],vt);for(;t.length;){const l=t.pop();if(l.isLeftEndpoint){const s=new St(l);for(let o=0;o<r.data.length;o++){const i=r.data[o];if(e&&i.leftSweepEvent.featureId===l.featureId)continue;const a=Et(s,i);a!==!1&&n.push(a)}r.push(s)}else l.isLeftEndpoint===!1&&r.pop()}return n}function Pt(t,e){const n=new Te([],De);return bt(t,n),Lt(n,e)}var kt=Pt;function we(t,e,n={}){const{removeDuplicates:r=!0,ignoreSelfIntersections:l=!0}=n;let s=[];t.type==="FeatureCollection"?s=s.concat(t.features):t.type==="Feature"?s.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&s.push(_e(t)),e.type==="FeatureCollection"?s=s.concat(e.features):e.type==="Feature"?s.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&s.push(_e(e));const o=kt(pe(s),l);let i=[];if(r){const a={};o.forEach(p=>{const d=p.join(",");a[d]||(a[d]=!0,i.push(p))})}else i=o;return pe(i.map(a=>Qe(a)))}function ge(t,e={}){const n=le(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),n.type){case"Polygon":return Ct(n,e);case"MultiPolygon":return It(n,e);default:throw new Error("invalid poly")}}function Ct(t,e={}){const r=le(t).coordinates,l=e.properties?e.properties:t.type==="Feature"?t.properties:{};return Ge(r,l)}function It(t,e={}){const r=le(t).coordinates,l=e.properties?e.properties:t.type==="Feature"?t.properties:{},s=[];return r.forEach(o=>{s.push(Ge(o,l))}),pe(s)}function Ge(t,e){return t.length>1?ze(t,e):He(t[0],e)}function Ft(t,e,{ignoreSelfIntersections:n=!0}={ignoreSelfIntersections:!0}){let r=!0;return oe(t,l=>{oe(e,s=>{if(r===!1)return!1;r=Mt(l.geometry,s.geometry,n)})}),r}function Mt(t,e,n){switch(t.type){case"Point":switch(e.type){case"Point":return!jt(t.coordinates,e.coordinates);case"LineString":return!Ie(e,t);case"Polygon":return!x(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ie(t,e);case"LineString":return!Nt(t,e,n);case"Polygon":return!Fe(e,t,n)}break;case"Polygon":switch(e.type){case"Point":return!x(e,t);case"LineString":return!Fe(t,e,n);case"Polygon":return!At(e,t,n)}}return!1}function Ie(t,e){for(let n=0;n<t.coordinates.length-1;n++)if(Bt(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function Nt(t,e,n){return we(t,e,{ignoreSelfIntersections:n}).features.length>0}function Fe(t,e,n){for(const l of e.coordinates)if(x(l,t))return!0;return we(e,ge(t),{ignoreSelfIntersections:n}).features.length>0}function At(t,e,n){for(const l of t.coordinates[0])if(x(l,e))return!0;for(const l of e.coordinates[0])if(x(l,t))return!0;return we(ge(t),ge(e),{ignoreSelfIntersections:n}).features.length>0}function Bt(t,e,n){const r=n[0]-t[0],l=n[1]-t[1],s=e[0]-t[0],o=e[1]-t[1];return r*o-l*s!==0?!1:Math.abs(s)>=Math.abs(o)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:o>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}function jt(t,e){return t[0]===e[0]&&t[1]===e[1]}function Me(t,e,{ignoreSelfIntersections:n=!0}={}){let r=!1;return oe(t,l=>{oe(e,s=>{if(r===!0)return!0;r=!Ft(l.geometry,s.geometry,{ignoreSelfIntersections:n})})}),r}function Ne(t){let e,n,r,l,s,o,i,a=t[4].features.length+"",p,d,u,h,c,f,g=t[5].features.length+"",y,m,$=t[1].filter(Oe).length+"",S,v,P,b,N,k,w,C,E,M,D;function K(_){t[20](_)}let te={$$slots:{default:[Ot]},$$scope:{ctx:t}};t[6]!==void 0&&(te.checked=t[6]),b=new rt({props:te}),Z.push(()=>X(b,"checked",K));function ae(_){t[21](_)}let ne={onChange:t[10]};return t[7]!==void 0&&(ne.options=t[7]),w=new st({props:ne}),Z.push(()=>X(w,"options",ae)),{c(){e=G("button"),e.textContent="Swap",n=O(),r=G("button"),r.textContent="Zoom to fit",l=O(),s=G("div"),s.textContent="Sources",o=O(),i=G("p"),p=H(a),d=H(" sources"),u=O(),h=G("div"),h.textContent="Target",c=O(),f=G("p"),y=H(g),m=H(" targets, with "),S=H($),v=H(" matching a source"),P=O(),Q(b.$$.fragment),k=O(),Q(w.$$.fragment),W(e,"class","btn btn-secondary"),W(r,"class","btn btn-secondary"),V(s,"background",me),V(h,"background",Re)},m(_,L){F(_,e,L),F(_,n,L),F(_,r,L),F(_,l,L),F(_,s,L),F(_,o,L),F(_,i,L),j(i,p),j(i,d),F(_,u,L),F(_,h,L),F(_,c,L),F(_,f,L),j(f,y),j(f,m),j(f,S),j(f,v),F(_,P,L),q(b,_,L),F(_,k,L),q(w,_,L),E=!0,M||(D=[he(e,"click",t[13]),he(r,"click",t[12])],M=!0)},p(_,L){(!E||L&16)&&a!==(a=_[4].features.length+"")&&fe(p,a),(!E||L&32)&&g!==(g=_[5].features.length+"")&&fe(y,g),(!E||L&2)&&$!==($=_[1].filter(Oe).length+"")&&fe(S,$);const ue={};L&4194304&&(ue.$$scope={dirty:L,ctx:_}),!N&&L&64&&(N=!0,ue.checked=_[6],Y(()=>N=!1)),b.$set(ue);const ye={};!C&&L&128&&(C=!0,ye.options=_[7],Y(()=>C=!1)),w.$set(ye)},i(_){E||(J(b.$$.fragment,_),J(w.$$.fragment,_),E=!0)},o(_){T(b.$$.fragment,_),T(w.$$.fragment,_),E=!1},d(_){_&&(I(e),I(n),I(r),I(l),I(s),I(o),I(i),I(u),I(h),I(c),I(f),I(P),I(k)),R(b,_),R(w,_),M=!1,it(D)}}}function Ot(t){let e;return{c(){e=H("Show targets matching a source")},m(n,r){F(n,e,r)},d(n){n&&I(e)}}}function Jt(t){let e,n,r,l,s,o,i,a,p,d,u,h,c=t[4].features.length>0&&Ne(t);return{c(){e=G("div"),n=G("h1"),n.textContent="Match LineStrings",r=O(),l=G("a"),l.textContent="Looking for the tool to review test cases?",s=O(),o=G("label"),i=H(`Load two .geojson files
      `),a=G("input"),p=O(),c&&c.c(),W(l,"href","review.html"),W(a,"class","form-control"),W(a,"type","file"),a.multiple=!0,W(o,"class","form-label"),W(e,"slot","left")},m(f,g){F(f,e,g),j(e,n),j(e,r),j(e,l),j(e,s),j(e,o),j(o,i),j(o,a),t[19](a),j(e,p),c&&c.m(e,null),d=!0,u||(h=he(a,"change",t[11]),u=!0)},p(f,g){f[4].features.length>0?c?(c.p(f,g),g&16&&J(c,1)):(c=Ne(f),c.c(),J(c,1),c.m(e,null)):c&&(xe(),T(c,1,1,()=>{c=null}),et())},i(f){d||(J(c),d=!0)},o(f){T(c),d=!1},d(f){f&&I(e),t[19](null),c&&c.d(),u=!1,h()}}}function Tt(t){let e,n;return e=new Je({props:{manageHoverState:!0,paint:{"line-width":["case",["in",["id"],["literal",t[9]]],8,5],"line-color":me,"line-opacity":de(.5,1)}}}),{c(){Q(e.$$.fragment)},m(r,l){q(e,r,l),n=!0},p(r,l){const s={};l&512&&(s.paint={"line-width":["case",["in",["id"],["literal",r[9]]],8,5],"line-color":me,"line-opacity":de(.5,1)}),e.$set(s)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Dt(t){let e,n,r;function l(o){t[16](o)}let s={manageHoverState:!0,filter:t[6]?void 0:["!",["get","has_match"]],paint:{"line-width":8,"line-color":Re,"line-opacity":de(["case",["get","has_match"],.5,.2],1)}};return t[0]!==void 0&&(s.hovered=t[0]),e=new Je({props:s}),Z.push(()=>X(e,"hovered",l)),e.$on("click",t[14]),{c(){Q(e.$$.fragment)},m(o,i){q(e,o,i),r=!0},p(o,i){const a={};i&64&&(a.filter=o[6]?void 0:["!",["get","has_match"]]),!n&&i&1&&(n=!0,a.hovered=o[0],Y(()=>n=!1)),e.$set(a)},i(o){r||(J(e.$$.fragment,o),r=!0)},o(o){T(e.$$.fragment,o),r=!1},d(o){R(e,o)}}}function Gt(t){let e,n,r,l,s,o,i,a,p,d,u;e=new ot({props:{map:t[2]}}),r=new lt({props:{map:t[2]}});function h(f){t[15](f)}let c={choice:"Maptiler Dataviz"};return t[3]!==void 0&&(c.style=t[3]),s=new at({props:c}),Z.push(()=>X(s,"style",h)),a=new Se({props:{data:t[4],$$slots:{default:[Tt]},$$scope:{ctx:t}}}),d=new Se({props:{data:t[5],$$slots:{default:[Dt]},$$scope:{ctx:t}}}),{c(){Q(e.$$.fragment),n=O(),Q(r.$$.fragment),l=O(),Q(s.$$.fragment),i=O(),Q(a.$$.fragment),p=O(),Q(d.$$.fragment)},m(f,g){q(e,f,g),F(f,n,g),q(r,f,g),F(f,l,g),q(s,f,g),F(f,i,g),q(a,f,g),F(f,p,g),q(d,f,g),u=!0},p(f,g){const y={};g&4&&(y.map=f[2]),e.$set(y);const m={};g&4&&(m.map=f[2]),r.$set(m);const $={};!o&&g&8&&(o=!0,$.style=f[3],Y(()=>o=!1)),s.$set($);const S={};g&16&&(S.data=f[4]),g&4194816&&(S.$$scope={dirty:g,ctx:f}),a.$set(S);const v={};g&32&&(v.data=f[5]),g&4194369&&(v.$$scope={dirty:g,ctx:f}),d.$set(v)},i(f){u||(J(e.$$.fragment,f),J(r.$$.fragment,f),J(s.$$.fragment,f),J(a.$$.fragment,f),J(d.$$.fragment,f),u=!0)},o(f){T(e.$$.fragment,f),T(r.$$.fragment,f),T(s.$$.fragment,f),T(a.$$.fragment,f),T(d.$$.fragment,f),u=!1},d(f){f&&(I(n),I(l),I(i),I(p)),R(e,f),R(r,f),R(s,f),R(a,f),R(d,f)}}}function Rt(t){let e,n,r,l;function s(i){t[17](i)}let o={style:t[3],hash:!0,$$slots:{default:[Gt]},$$scope:{ctx:t}};return t[2]!==void 0&&(o.map=t[2]),n=new tt({props:o}),Z.push(()=>X(n,"map",s)),n.$on("error",t[18]),{c(){e=G("div"),Q(n.$$.fragment),W(e,"slot","main"),V(e,"position","relative"),V(e,"width","100%"),V(e,"height","100vh")},m(i,a){F(i,e,a),q(n,e,null),l=!0},p(i,a){const p={};a&8&&(p.style=i[3]),a&4194941&&(p.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,p.map=i[2],Y(()=>r=!1)),n.$set(p)},i(i){l||(J(n.$$.fragment,i),l=!0)},o(i){T(n.$$.fragment,i),l=!1},d(i){i&&I(e),R(n)}}}function qt(t){let e,n;return e=new Ze({props:{$$slots:{main:[Rt],left:[Jt]},$$scope:{ctx:t}}}),{c(){Q(e.$$.fragment)},m(r,l){q(e,r,l),n=!0},p(r,[l]){const s={};l&4195327&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}let me="red",Re="blue";async function Ae(t){let e=await t.text(),n=JSON.parse(e),r=0;for(let l of n.features)l.id=r++,l.properties??(l.properties={});return n}function Be(t){let e=JSON.parse(JSON.stringify(t));return delete e.properties,e}function je(t){let e=0;for(let n of t)n.id=e++;return t}const Oe=t=>t.matching_sources.length>0;function Qt(t,e,n){let r,l,s=Ye["Maptiler Dataviz"],o=$e(),i=$e(),a=null,p=!0,d={buffer_meters:20,angle_diff_threshold:10,length_ratio_threshold:1.1,midpt_dist_threshold:15},u=[];Ve(async()=>{await Xe()});function h(){try{n(1,u=JSON.parse(nt(JSON.stringify(o),JSON.stringify(i),d)))}catch(w){window.alert(`Bug: ${w}`);return}for(let[w,C]of i.features.entries())C.properties.has_match=u[w].matching_sources.length>0;n(5,i)}let c;async function f(w){if(!c.files)return;if(c.files.length!=2){window.alert("Select two GeoJSON files");return}try{n(4,o=await Ae(c.files[0])),n(5,i=await Ae(c.files[1])),g(),n(0,a=null),h()}catch(E){window.alert(`Bad input file: ${E}`)}}function g(){let w={type:"FeatureCollection",features:[...o.features,...i.features]};l==null||l.fitBounds(ve(w),{animate:!1,padding:10})}function y(){n(4,[o,i]=[i,o],o,n(5,i)),h()}function m(w){let C=i.features[w.detail.features[0].id],E=ut(ve(C));be("sources.geojson",JSON.stringify({type:"FeatureCollection",features:je(o.features.filter(M=>Me(M,E)).map(Be))})),be("targets.geojson",JSON.stringify({type:"FeatureCollection",features:je(i.features.filter(M=>Me(M,E)).map(Be))}))}function $(w){s=w,n(3,s)}function S(w){a=w,n(0,a)}function v(w){l=w,n(2,l)}const P=w=>{console.log(w.detail.error)};function b(w){Z[w?"unshift":"push"](()=>{c=w,n(8,c)})}function N(w){p=w,n(6,p)}function k(w){d=w,n(7,d)}return t.$$.update=()=>{t.$$.dirty&3&&n(9,r=a==null?[]:u[a.id].matching_sources)},[a,u,l,s,o,i,p,d,c,r,h,f,g,y,m,$,S,v,P,b,N,k]}class zt extends We{constructor(e){super(),Ke(this,e,Qt,qt,Ue,{})}}new zt({target:document.getElementById("app")});
