import{p as Ge,f as ye,a as ce,b as Re,m as qe,l as Qe,c as se,S as ze,i as He,s as We,L as Ke,d as q,t as R,e as D,g as Q,h as z,o as Ze,_ as Ue,j as Ve,k as we,n as M,q as Xe,r as Ye,u as N,v as B,w as re,x as O,y as T,z as K,A as G,M as xe,B as X,C as ie,D as oe,E as U,F as et,G as _e,H as ve,I as tt,J as nt,K as ue,N as rt,O as st,P as be,Q as je,R as pe}from"./Settings-C_jMbddS.js";function it(t,e={}){const n=Number(t[0]),r=Number(t[1]),a=Number(t[2]),s=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const i=[n,r];return Ge([[i,[a,r],[a,s],[n,s],i]],e.properties,{bbox:t,id:e.id})}const H=11102230246251565e-32,A=134217729,ot=(3+8*H)*H;function fe(t,e,n,r,a){let s,i,o,u,p=e[0],h=r[0],c=0,l=0;h>p==h>-p?(s=p,p=e[++c]):(s=h,h=r[++l]);let f=0;if(c<t&&l<n)for(h>p==h>-p?(i=p+s,o=s-(i-p),p=e[++c]):(i=h+s,o=s-(i-h),h=r[++l]),s=i,o!==0&&(a[f++]=o);c<t&&l<n;)h>p==h>-p?(i=s+p,u=i-s,o=s-(i-u)+(p-u),p=e[++c]):(i=s+h,u=i-s,o=s-(i-u)+(h-u),h=r[++l]),s=i,o!==0&&(a[f++]=o);for(;c<t;)i=s+p,u=i-s,o=s-(i-u)+(p-u),p=e[++c],s=i,o!==0&&(a[f++]=o);for(;l<n;)i=s+h,u=i-s,o=s-(i-u)+(h-u),h=r[++l],s=i,o!==0&&(a[f++]=o);return(s!==0||f===0)&&(a[f++]=s),f}function lt(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Y(t){return new Float64Array(t)}const at=(3+16*H)*H,ut=(2+12*H)*H,ft=(9+64*H)*H*H,Z=Y(4),$e=Y(8),Se=Y(12),Ee=Y(16),j=Y(4);function ct(t,e,n,r,a,s,i){let o,u,p,h,c,l,f,g,d,y,m,v,L,b,P,$,C,k;const w=t-a,S=n-a,F=e-s,E=r-s;b=w*E,l=A*w,f=l-(l-w),g=w-f,l=A*E,d=l-(l-E),y=E-d,P=g*y-(b-f*d-g*d-f*y),$=F*S,l=A*F,f=l-(l-F),g=F-f,l=A*S,d=l-(l-S),y=S-d,C=g*y-($-f*d-g*d-f*y),m=P-C,c=P-m,Z[0]=P-(m+c)+(c-C),v=b+m,c=v-b,L=b-(v-c)+(m-c),m=L-$,c=L-m,Z[1]=L-(m+c)+(c-$),k=v+m,c=k-v,Z[2]=v-(k-c)+(m-c),Z[3]=k;let J=lt(4,Z),W=ut*i;if(J>=W||-J>=W||(c=t-w,o=t-(w+c)+(c-a),c=n-S,p=n-(S+c)+(c-a),c=e-F,u=e-(F+c)+(c-s),c=r-E,h=r-(E+c)+(c-s),o===0&&u===0&&p===0&&h===0)||(W=ft*i+ot*Math.abs(J),J+=w*h+E*o-(F*p+S*u),J>=W||-J>=W))return J;b=o*E,l=A*o,f=l-(l-o),g=o-f,l=A*E,d=l-(l-E),y=E-d,P=g*y-(b-f*d-g*d-f*y),$=u*S,l=A*u,f=l-(l-u),g=u-f,l=A*S,d=l-(l-S),y=S-d,C=g*y-($-f*d-g*d-f*y),m=P-C,c=P-m,j[0]=P-(m+c)+(c-C),v=b+m,c=v-b,L=b-(v-c)+(m-c),m=L-$,c=L-m,j[1]=L-(m+c)+(c-$),k=v+m,c=k-v,j[2]=v-(k-c)+(m-c),j[3]=k;const ae=fe(4,Z,4,j,$e);b=w*h,l=A*w,f=l-(l-w),g=w-f,l=A*h,d=l-(l-h),y=h-d,P=g*y-(b-f*d-g*d-f*y),$=F*p,l=A*F,f=l-(l-F),g=F-f,l=A*p,d=l-(l-p),y=p-d,C=g*y-($-f*d-g*d-f*y),m=P-C,c=P-m,j[0]=P-(m+c)+(c-C),v=b+m,c=v-b,L=b-(v-c)+(m-c),m=L-$,c=L-m,j[1]=L-(m+c)+(c-$),k=v+m,c=k-v,j[2]=v-(k-c)+(m-c),j[3]=k;const x=fe(ae,$e,4,j,Se);b=o*h,l=A*o,f=l-(l-o),g=o-f,l=A*h,d=l-(l-h),y=h-d,P=g*y-(b-f*d-g*d-f*y),$=u*p,l=A*u,f=l-(l-u),g=u-f,l=A*p,d=l-(l-p),y=p-d,C=g*y-($-f*d-g*d-f*y),m=P-C,c=P-m,j[0]=P-(m+c)+(c-C),v=b+m,c=v-b,L=b-(v-c)+(m-c),m=L-$,c=L-m,j[1]=L-(m+c)+(c-$),k=v+m,c=k-v,j[2]=v-(k-c)+(m-c),j[3]=k;const _=fe(x,Se,4,j,Ee);return Ee[_-1]}function pt(t,e,n,r,a,s){const i=(e-s)*(n-a),o=(t-a)*(r-s),u=i-o,p=Math.abs(i+o);return Math.abs(u)>=at*p?u:-ct(t,e,n,r,a,s,p)}function ht(t,e){var n,r,a=0,s,i,o,u,p,h,c,l=t[0],f=t[1],g=e.length;for(n=0;n<g;n++){r=0;var d=e[n],y=d.length-1;if(h=d[0],h[0]!==d[y][0]&&h[1]!==d[y][1])throw new Error("First and last coordinates in a ring must be the same");for(i=h[0]-l,o=h[1]-f,r;r<y;r++){if(c=d[r+1],u=c[0]-l,p=c[1]-f,o===0&&p===0){if(u<=0&&i>=0||i<=0&&u>=0)return 0}else if(p>=0&&o<=0||p<=0&&o>=0){if(s=pt(i,u,o,p,0,0),s===0)return 0;(s>0&&p>0&&o<=0||s<0&&p<=0&&o>0)&&a++}h=c,o=p,i=u}}return a%2!==0}function dt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function le(t){return t.type==="Feature"?t.geometry:t}function V(t,e,n={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const r=dt(t),a=le(e),s=a.type,i=e.bbox;let o=a.coordinates;if(i&&gt(r,i)===!1)return!1;s==="Polygon"&&(o=[o]);let u=!1;for(var p=0;p<o.length;++p){const h=ht(r,o[p]);if(h===0)return!n.ignoreBoundary;h&&(u=!0)}return u}function gt(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}class Oe{constructor(e=[],n=mt){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:r}=this,a=n[e];for(;e>0;){const s=e-1>>1,i=n[s];if(r(a,i)>=0)break;n[e]=i,e=s}n[e]=a}_down(e){const{data:n,compare:r}=this,a=this.length>>1,s=n[e];for(;e<a;){let i=(e<<1)+1,o=n[i];const u=i+1;if(u<this.length&&r(n[u],o)<0&&(i=u,o=n[u]),r(o,s)>=0)break;n[e]=o,e=i}n[e]=s}}function mt(t,e){return t<e?-1:t>e?1:0}function Je(t,e){return t.p.x>e.p.x?1:t.p.x<e.p.x?-1:t.p.y!==e.p.y?t.p.y>e.p.y?1:-1:1}function yt(t,e){return t.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:t.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:t.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?t.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class Le{constructor(e,n,r,a){this.p={x:e[0],y:e[1]},this.featureId=n,this.ringId=r,this.eventId=a,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(e){return this.p.x===e.p.x&&this.p.y===e.p.y}}function wt(t,e){if(t.type==="FeatureCollection"){const n=t.features;for(let r=0;r<n.length;r++)Pe(n[r],e)}else Pe(t,e)}let ee=0,te=0,ne=0;function Pe(t,e){const n=t.type==="Feature"?t.geometry:t;let r=n.coordinates;(n.type==="Polygon"||n.type==="MultiLineString")&&(r=[r]),n.type==="LineString"&&(r=[[r]]);for(let a=0;a<r.length;a++)for(let s=0;s<r[a].length;s++){let i=r[a][s][0],o=null;te=te+1;for(let u=0;u<r[a][s].length-1;u++){o=r[a][s][u+1];const p=new Le(i,ee,te,ne),h=new Le(o,ee,te,ne+1);p.otherEvent=h,h.otherEvent=p,Je(p,h)>0?(h.isLeftEndpoint=!0,p.isLeftEndpoint=!1):(p.isLeftEndpoint=!0,h.isLeftEndpoint=!1),e.push(p),e.push(h),i=o,ne=ne+1}}ee=ee+1}class _t{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}function vt(t,e){if(t===null||e===null||t.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.rightSweepEvent)||t.leftSweepEvent.isSamePoint(e.leftSweepEvent)||t.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const n=t.leftSweepEvent.p.x,r=t.leftSweepEvent.p.y,a=t.rightSweepEvent.p.x,s=t.rightSweepEvent.p.y,i=e.leftSweepEvent.p.x,o=e.leftSweepEvent.p.y,u=e.rightSweepEvent.p.x,p=e.rightSweepEvent.p.y,h=(p-o)*(a-n)-(u-i)*(s-r),c=(u-i)*(r-o)-(p-o)*(n-i),l=(a-n)*(r-o)-(s-r)*(n-i);if(h===0)return!1;const f=c/h,g=l/h;if(f>=0&&f<=1&&g>=0&&g<=1){const d=n+f*(a-n),y=r+f*(s-r);return[d,y]}return!1}function bt(t,e){e=e||!1;const n=[],r=new Oe([],yt);for(;t.length;){const a=t.pop();if(a.isLeftEndpoint){const s=new _t(a);for(let i=0;i<r.data.length;i++){const o=r.data[i];if(e&&o.leftSweepEvent.featureId===a.featureId)continue;const u=vt(s,o);u!==!1&&n.push(u)}r.push(s)}else a.isLeftEndpoint===!1&&r.pop()}return n}function $t(t,e){const n=new Oe([],Je);return wt(t,n),bt(n,e)}var St=$t;function ge(t,e,n={}){const{removeDuplicates:r=!0,ignoreSelfIntersections:a=!0}=n;let s=[];t.type==="FeatureCollection"?s=s.concat(t.features):t.type==="Feature"?s.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&s.push(ye(t)),e.type==="FeatureCollection"?s=s.concat(e.features):e.type==="Feature"?s.push(e):(e.type==="LineString"||e.type==="Polygon"||e.type==="MultiLineString"||e.type==="MultiPolygon")&&s.push(ye(e));const i=St(ce(s),a);let o=[];if(r){const u={};i.forEach(p=>{const h=p.join(",");u[h]||(u[h]=!0,o.push(p))})}else o=i;return ce(o.map(u=>Re(u)))}function he(t,e={}){const n=le(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),n.type){case"Polygon":return Et(n,e);case"MultiPolygon":return Lt(n,e);default:throw new Error("invalid poly")}}function Et(t,e={}){const r=le(t).coordinates,a=e.properties?e.properties:t.type==="Feature"?t.properties:{};return Te(r,a)}function Lt(t,e={}){const r=le(t).coordinates,a=e.properties?e.properties:t.type==="Feature"?t.properties:{},s=[];return r.forEach(i=>{s.push(Te(i,a))}),ce(s)}function Te(t,e){return t.length>1?qe(t,e):Qe(t[0],e)}function Pt(t,e,{ignoreSelfIntersections:n=!0}={ignoreSelfIntersections:!0}){let r=!0;return se(t,a=>{se(e,s=>{if(r===!1)return!1;r=Ct(a.geometry,s.geometry,n)})}),r}function Ct(t,e,n){switch(t.type){case"Point":switch(e.type){case"Point":return!Mt(t.coordinates,e.coordinates);case"LineString":return!Ce(e,t);case"Polygon":return!V(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ce(t,e);case"LineString":return!kt(t,e,n);case"Polygon":return!ke(e,t,n)}break;case"Polygon":switch(e.type){case"Point":return!V(e,t);case"LineString":return!ke(t,e,n);case"Polygon":return!It(e,t,n)}}return!1}function Ce(t,e){for(let n=0;n<t.coordinates.length-1;n++)if(Ft(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function kt(t,e,n){return ge(t,e,{ignoreSelfIntersections:n}).features.length>0}function ke(t,e,n){for(const a of e.coordinates)if(V(a,t))return!0;return ge(e,he(t),{ignoreSelfIntersections:n}).features.length>0}function It(t,e,n){for(const a of t.coordinates[0])if(V(a,e))return!0;for(const a of e.coordinates[0])if(V(a,t))return!0;return ge(he(t),he(e),{ignoreSelfIntersections:n}).features.length>0}function Ft(t,e,n){const r=n[0]-t[0],a=n[1]-t[1],s=e[0]-t[0],i=e[1]-t[1];return r*i-a*s!==0?!1:Math.abs(s)>=Math.abs(i)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:i>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}function Mt(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ie(t,e,{ignoreSelfIntersections:n=!0}={}){let r=!1;return se(t,a=>{se(e,s=>{if(r===!0)return!0;r=!Pt(a.geometry,s.geometry,{ignoreSelfIntersections:n})})}),r}function Fe(t){let e,n,r,a,s,i,o,u=t[4].features.length+"",p,h,c,l,f,g,d=t[5].features.length+"",y,m,v=t[1].filter(Be).length+"",L,b,P,$,C,k,w,S,F,E,J,W;function ae(_){t[21](_)}let x={onChange:t[10]};return t[7]!==void 0&&(x.options=t[7]),S=new tt({props:x}),X.push(()=>ie(S,"options",ae)),{c(){e=O("button"),e.textContent="Swap",n=T(),r=O("button"),r.textContent="Zoom to fit",a=T(),s=O("div"),s.textContent="Sources",i=T(),o=O("p"),p=K(u),h=K(" sources"),c=T(),l=O("div"),l.textContent="Target",f=T(),g=O("p"),y=K(d),m=K(" targets, with "),L=K(v),b=K(" matching a source"),P=T(),$=O("label"),C=O("input"),k=K(`
        Show targets matching a source`),w=T(),z(S.$$.fragment),G(e,"class","btn btn-secondary"),G(r,"class","btn btn-secondary"),U(s,"background",de),U(l,"background",De),G(C,"class","form-check-input"),G(C,"type","checkbox"),G($,"class","form-check-label mb-3")},m(_,I){N(_,e,I),N(_,n,I),N(_,r,I),N(_,a,I),N(_,s,I),N(_,i,I),N(_,o,I),B(o,p),B(o,h),N(_,c,I),N(_,l,I),N(_,f,I),N(_,g,I),B(g,y),B(g,m),B(g,L),B(g,b),N(_,P,I),N(_,$,I),B($,C),C.checked=t[6],B($,k),N(_,w,I),Q(S,_,I),E=!0,J||(W=[re(e,"click",t[13]),re(r,"click",t[12]),re(C,"change",t[20])],J=!0)},p(_,I){(!E||I&16)&&u!==(u=_[4].features.length+"")&&ue(p,u),(!E||I&32)&&d!==(d=_[5].features.length+"")&&ue(y,d),(!E||I&2)&&v!==(v=_[1].filter(Be).length+"")&&ue(L,v),I&64&&(C.checked=_[6]);const me={};!F&&I&128&&(F=!0,me.options=_[7],oe(()=>F=!1)),S.$set(me)},i(_){E||(D(S.$$.fragment,_),E=!0)},o(_){R(S.$$.fragment,_),E=!1},d(_){_&&(M(e),M(n),M(r),M(a),M(s),M(i),M(o),M(c),M(l),M(f),M(g),M(P),M($),M(w)),q(S,_),J=!1,nt(W)}}}function Nt(t){let e,n,r,a,s,i,o,u,p,h,c,l,f=t[4].features.length>0&&Fe(t);return{c(){e=O("div"),n=O("h1"),n.textContent="Match LineStrings",r=T(),a=O("a"),a.textContent="Looking for the tool to review test cases?",s=T(),i=O("label"),o=K(`Load two .geojson files
      `),u=O("input"),p=T(),f&&f.c(),G(a,"href","review.html"),G(u,"class","form-control"),G(u,"type","file"),u.multiple=!0,G(i,"class","form-label"),G(e,"slot","left")},m(g,d){N(g,e,d),B(e,n),B(e,r),B(e,a),B(e,s),B(e,i),B(i,o),B(i,u),t[19](u),B(e,p),f&&f.m(e,null),h=!0,c||(l=re(u,"change",t[11]),c=!0)},p(g,d){g[4].features.length>0?f?(f.p(g,d),d&16&&D(f,1)):(f=Fe(g),f.c(),D(f,1),f.m(e,null)):f&&(Xe(),R(f,1,1,()=>{f=null}),Ye())},i(g){h||(D(f),h=!0)},o(g){R(f),h=!1},d(g){g&&M(e),t[19](null),f&&f.d(),c=!1,l()}}}function At(t){let e,n;return e=new je({props:{manageHoverState:!0,paint:{"line-width":["case",["in",["id"],["literal",t[9]]],8,5],"line-color":de,"line-opacity":pe(.5,1)}}}),{c(){z(e.$$.fragment)},m(r,a){Q(e,r,a),n=!0},p(r,a){const s={};a&512&&(s.paint={"line-width":["case",["in",["id"],["literal",r[9]]],8,5],"line-color":de,"line-opacity":pe(.5,1)}),e.$set(s)},i(r){n||(D(e.$$.fragment,r),n=!0)},o(r){R(e.$$.fragment,r),n=!1},d(r){q(e,r)}}}function Bt(t){let e,n,r;function a(i){t[16](i)}let s={manageHoverState:!0,filter:t[6]?void 0:["!",["get","has_match"]],paint:{"line-width":8,"line-color":De,"line-opacity":pe(["case",["get","has_match"],.5,.2],1)}};return t[0]!==void 0&&(s.hovered=t[0]),e=new je({props:s}),X.push(()=>ie(e,"hovered",a)),e.$on("click",t[14]),{c(){z(e.$$.fragment)},m(i,o){Q(e,i,o),r=!0},p(i,o){const u={};o&64&&(u.filter=i[6]?void 0:["!",["get","has_match"]]),!n&&o&1&&(n=!0,u.hovered=i[0],oe(()=>n=!1)),e.$set(u)},i(i){r||(D(e.$$.fragment,i),r=!0)},o(i){R(e.$$.fragment,i),r=!1},d(i){q(e,i)}}}function jt(t){let e,n,r,a,s,i,o,u,p;e=new rt({props:{map:t[2]}});function h(l){t[15](l)}let c={choice:"Maptiler Dataviz"};return t[3]!==void 0&&(c.style=t[3]),r=new st({props:c}),X.push(()=>ie(r,"style",h)),i=new be({props:{data:t[4],$$slots:{default:[At]},$$scope:{ctx:t}}}),u=new be({props:{data:t[5],$$slots:{default:[Bt]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment),n=T(),z(r.$$.fragment),s=T(),z(i.$$.fragment),o=T(),z(u.$$.fragment)},m(l,f){Q(e,l,f),N(l,n,f),Q(r,l,f),N(l,s,f),Q(i,l,f),N(l,o,f),Q(u,l,f),p=!0},p(l,f){const g={};f&4&&(g.map=l[2]),e.$set(g);const d={};!a&&f&8&&(a=!0,d.style=l[3],oe(()=>a=!1)),r.$set(d);const y={};f&16&&(y.data=l[4]),f&4194816&&(y.$$scope={dirty:f,ctx:l}),i.$set(y);const m={};f&32&&(m.data=l[5]),f&4194369&&(m.$$scope={dirty:f,ctx:l}),u.$set(m)},i(l){p||(D(e.$$.fragment,l),D(r.$$.fragment,l),D(i.$$.fragment,l),D(u.$$.fragment,l),p=!0)},o(l){R(e.$$.fragment,l),R(r.$$.fragment,l),R(i.$$.fragment,l),R(u.$$.fragment,l),p=!1},d(l){l&&(M(n),M(s),M(o)),q(e,l),q(r,l),q(i,l),q(u,l)}}}function Ot(t){let e,n,r,a;function s(o){t[17](o)}let i={style:t[3],hash:!0,$$slots:{default:[jt]},$$scope:{ctx:t}};return t[2]!==void 0&&(i.map=t[2]),n=new xe({props:i}),X.push(()=>ie(n,"map",s)),n.$on("error",t[18]),{c(){e=O("div"),z(n.$$.fragment),G(e,"slot","main"),U(e,"position","relative"),U(e,"width","100%"),U(e,"height","100vh")},m(o,u){N(o,e,u),Q(n,e,null),a=!0},p(o,u){const p={};u&8&&(p.style=o[3]),u&4194941&&(p.$$scope={dirty:u,ctx:o}),!r&&u&4&&(r=!0,p.map=o[2],oe(()=>r=!1)),n.$set(p)},i(o){a||(D(n.$$.fragment,o),a=!0)},o(o){R(n.$$.fragment,o),a=!1},d(o){o&&M(e),q(n)}}}function Jt(t){let e,n;return e=new Ke({props:{$$slots:{main:[Ot],left:[Nt]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment)},m(r,a){Q(e,r,a),n=!0},p(r,[a]){const s={};a&4195327&&(s.$$scope={dirty:a,ctx:r}),e.$set(s)},i(r){n||(D(e.$$.fragment,r),n=!0)},o(r){R(e.$$.fragment,r),n=!1},d(r){q(e,r)}}}let de="red",De="blue";async function Me(t){let e=await t.text(),n=JSON.parse(e),r=0;for(let a of n.features)a.id=r++,a.properties??(a.properties={});return n}function Ne(t){let e=JSON.parse(JSON.stringify(t));return delete e.properties,e}function Ae(t){let e=0;for(let n of t)n.id=e++;return t}const Be=t=>t.matching_sources.length>0;function Tt(t,e,n){let r,a,s=Ve["Maptiler Dataviz"],i=we(),o=we(),u=null,p=!0,h={buffer_meters:20,angle_diff_threshold:10,length_ratio_threshold:1.1,midpt_dist_threshold:15},c=[];Ze(async()=>{await Ue()});function l(){try{n(1,c=JSON.parse(et(JSON.stringify(i),JSON.stringify(o),h)))}catch(w){window.alert(`Bug: ${w}`);return}for(let[w,S]of o.features.entries())S.properties.has_match=c[w].matching_sources.length>0;n(5,o)}let f;async function g(w){if(!f.files)return;if(f.files.length!=2){window.alert("Select two GeoJSON files");return}try{n(4,i=await Me(f.files[0])),n(5,o=await Me(f.files[1])),d(),n(0,u=null),l()}catch(F){window.alert(`Bad input file: ${F}`)}}function d(){let w={type:"FeatureCollection",features:[...i.features,...o.features]};a==null||a.fitBounds(_e(w),{animate:!1,padding:10})}function y(){n(4,[i,o]=[o,i],i,n(5,o)),l()}function m(w){let S=o.features[w.detail.features[0].id],F=it(_e(S));ve("sources.geojson",JSON.stringify({type:"FeatureCollection",features:Ae(i.features.filter(E=>Ie(E,F)).map(Ne))})),ve("targets.geojson",JSON.stringify({type:"FeatureCollection",features:Ae(o.features.filter(E=>Ie(E,F)).map(Ne))}))}function v(w){s=w,n(3,s)}function L(w){u=w,n(0,u)}function b(w){a=w,n(2,a)}const P=w=>{console.log(w.detail.error)};function $(w){X[w?"unshift":"push"](()=>{f=w,n(8,f)})}function C(){p=this.checked,n(6,p)}function k(w){h=w,n(7,h)}return t.$$.update=()=>{t.$$.dirty&3&&n(9,r=u==null?[]:c[u.id].matching_sources)},[u,c,a,s,i,o,p,h,f,r,l,g,d,y,m,v,L,b,P,$,C,k]}class Dt extends ze{constructor(e){super(),He(this,e,Tt,Jt,We,{})}}new Dt({target:document.getElementById("app")});
